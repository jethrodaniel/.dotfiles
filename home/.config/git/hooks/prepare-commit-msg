#!/usr/bin/env ruby

require_relative '../git_helpers'

if __FILE__ == $0
  message_file = ARGV[0]

  branch = GitHelpers.current_branch
  issue = GitHelpers.issue_number branch

  recent_commits = `git log -5 --oneline --decorate`.split("\n")
                                                    .map { |s| "# #{s}" }
                                                    .join "\n"
  commit_template = File.read message_file

  commit_message = ERB.new(commit_template).result.gsub '[#]', ''

  File.write message_file, commit_message
end
